{% extends "base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
        <h2 class="text-3xl font-bold text-white">Model Performance & Metrics</h2>
        <p class="text-gray-400 mt-2">Transparent evaluation on clinical test data.</p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-12">
        <div class="glass-card p-6 rounded-xl border-l-4 border-crimson">
            <p class="text-gray-400 text-sm uppercase tracking-wide">Accuracy</p>
            <p class="text-4xl font-bold text-white mt-2">{{ "%.1f"|format(metrics.accuracy * 100) }}%</p>
        </div>
        <div class="glass-card p-6 rounded-xl border-l-4 border-blue-500">
            <p class="text-gray-400 text-sm uppercase tracking-wide">ROC-AUC Score</p>
            <p class="text-4xl font-bold text-white mt-2">{{ "%.2f"|format(metrics.roc_auc) }}</p>
        </div>
        <div class="glass-card p-6 rounded-xl border-l-4 border-emerald-500">
            <p class="text-gray-400 text-sm uppercase tracking-wide">Precision (Recall)</p>
            <p class="text-4xl font-bold text-white mt-2">{{ "%.2f"|format(metrics.pr_auc) }}</p>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="glass-card p-6 rounded-xl">
            <h3 class="text-lg font-semibold text-white mb-4">Model Comparison</h3>
            <canvas id="comparisonChart"></canvas>
        </div>
        
        <div class="glass-card p-6 rounded-xl flex flex-col items-center justify-center">
            <h3 class="text-lg font-semibold text-white mb-4">Feature Importance (Top 5)</h3>
            <div class="w-full space-y-4">
                <div>
                    <div class="flex justify-between text-sm text-gray-300 mb-1">
                        <span>Systolic BP (ap_hi)</span>
                        <span>0.42</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2.5">
                        <div class="bg-crimson h-2.5 rounded-full" style="width: 85%"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-sm text-gray-300 mb-1">
                        <span>Age</span>
                        <span>0.28</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2.5">
                        <div class="bg-blue-500 h-2.5 rounded-full" style="width: 60%"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-sm text-gray-300 mb-1">
                        <span>Cholesterol</span>
                        <span>0.15</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2.5">
                        <div class="bg-purple-500 h-2.5 rounded-full" style="width: 35%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Comparison Chart Logic
    const ctx = document.getElementById('comparisonChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Logistic Regression', 'Decision Tree', 'Random Forest', 'XGBoost'],
            datasets: [{
                label: 'Accuracy',
                data: [0.72, 0.63, 0.71, 0.73],
                backgroundColor: [
                    'rgba(75, 192, 192, 0.5)',
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(225, 29, 72, 0.8)' // Highlight Best
                ],
                borderColor: 'rgba(255, 255, 255, 0.1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true,
                    max: 1.0,
                    grid: { color: 'rgba(255, 255, 255, 0.05)' },
                    ticks: { color: '#94a3b8' }
                },
                x: {
                    grid: { display: false },
                    ticks: { color: '#94a3b8' }
                }
            },
            plugins: {
                legend: { display: false }
            }
        }
    });
</script>
{% endblock %}